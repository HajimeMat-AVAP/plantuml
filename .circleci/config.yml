version: 2
jobs:
   build:
     docker:
       - image: koppor/texlive
     steps:
       - checkout
       - run: mkdir build
       - run: lualatex -shell-escape example-minimal && cp example-minimal.pdf example-minimal.png build/
       - run: lualatex -shell-escape example-class-relations  && cp example-class-relations.pdf example-class-relations.png build/
       - run: ctanify --notds plantuml.sty plantuml.lua README.md "*.png" "example-*.tex" && mkdir ctan && cp plantuml.tar.gz ctan/
       - run: cp -r README.md .github/_config.yml build/
       - run: if [ "$CIRCLE_BRANCH" == "master" ]; then .circleci/deploy-ghpages.sh build/; fi
